import 'dart:convert';

import 'package:built_value/serializer.dart';

Type typeOfElementsInList<T>(List<T> list) => T;
List<Type> typeOfElementsInMap<TK,TV>(Map<TK,TV> map) => [TK,TV];

/// Format the given parameter object into string.
String parameterToString(Serializers serializers, dynamic value) {
  if (value == null) {
    return '';
  } else if (value is String || value is num || value is bool) {
    return value.toString();
  } else if (value is DateTime) {
    return value.toIso8601String();
  } else {
    List<FullType> params = [];
    if (value is List) {
      params.add(FullType(typeOfElementsInList(value)));
    } else if (value is Map) {
      params.addAll(typeOfElementsInMap(value).map((e) => FullType(e)));
    }
    var serialized = serializers.serialize(value,
        specifiedType: FullType(value.runtimeType, params));
    return serialized;
  }
}
